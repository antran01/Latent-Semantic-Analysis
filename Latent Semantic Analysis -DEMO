{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":321},"executionInfo":{"elapsed":43426,"status":"error","timestamp":1725377942449,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"pAAbAEnu6cvy","outputId":"5dd9aa16-861e-4f81-c690-389a2fe652ce"},"outputs":[{"output_type":"error","ename":"MessageError","evalue":"Error: credential propagation was unsuccessful","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mMessageError\u001b[0m                              Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-c4a868a20ceb>\u001b[0m in \u001b[0;36m<cell line: 2>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mgoogle\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolab\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mdrive\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mdrive\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmount\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'/content/drive'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0mall_csv_path\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0;34m'/content/drive/MyDrive/DATA MINING MINI PROJECT/1.6/DATA'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;31m#chạy thì bỏ file zô path này)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/google/colab/drive.py\u001b[0m in \u001b[0;36mmount\u001b[0;34m(mountpoint, force_remount, timeout_ms, readonly)\u001b[0m\n\u001b[1;32m     98\u001b[0m \u001b[0;32mdef\u001b[0m \u001b[0mmount\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmountpoint\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mforce_remount\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtimeout_ms\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m120000\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreadonly\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     99\u001b[0m   \u001b[0;34m\"\"\"Mount your Google Drive at the specified mountpoint path.\"\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 100\u001b[0;31m   return _mount(\n\u001b[0m\u001b[1;32m    101\u001b[0m       \u001b[0mmountpoint\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    102\u001b[0m       \u001b[0mforce_remount\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mforce_remount\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/google/colab/drive.py\u001b[0m in \u001b[0;36m_mount\u001b[0;34m(mountpoint, force_remount, timeout_ms, ephemeral, readonly)\u001b[0m\n\u001b[1;32m    131\u001b[0m   )\n\u001b[1;32m    132\u001b[0m   \u001b[0;32mif\u001b[0m \u001b[0mephemeral\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 133\u001b[0;31m     _message.blocking_request(\n\u001b[0m\u001b[1;32m    134\u001b[0m         \u001b[0;34m'request_auth'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    135\u001b[0m         \u001b[0mrequest\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m'authType'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;34m'dfs_ephemeral'\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/google/colab/_message.py\u001b[0m in \u001b[0;36mblocking_request\u001b[0;34m(request_type, request, timeout_sec, parent)\u001b[0m\n\u001b[1;32m    174\u001b[0m       \u001b[0mrequest_type\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrequest\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparent\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mparent\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mexpect_reply\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    175\u001b[0m   )\n\u001b[0;32m--> 176\u001b[0;31m   \u001b[0;32mreturn\u001b[0m \u001b[0mread_reply_from_input\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrequest_id\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtimeout_sec\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/google/colab/_message.py\u001b[0m in \u001b[0;36mread_reply_from_input\u001b[0;34m(message_id, timeout_sec)\u001b[0m\n\u001b[1;32m    101\u001b[0m     ):\n\u001b[1;32m    102\u001b[0m       \u001b[0;32mif\u001b[0m \u001b[0;34m'error'\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mreply\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 103\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mMessageError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mreply\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'error'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    104\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0mreply\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'data'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    105\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mMessageError\u001b[0m: Error: credential propagation was unsuccessful"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')\n","all_csv_path = ('/content/drive/MyDrive/DATA MINING MINI PROJECT/1.6/DATA') #chạy thì bỏ file zô path này)"]},{"cell_type":"markdown","metadata":{"id":"rQoMuzNCa6jW"},"source":["IMPORT LIBRARIES\n"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":36,"status":"aborted","timestamp":1725377942450,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"MGWxibYeqGzz"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import re\n","import nltk\n","import spacy\n","import string\n","import glob\n","import csv\n","import os\n","import sys\n","import matplotlib.pyplot as plt\n","import pkg_resources\n","import multiprocessing as mp\n","!pip install symspellpy\n","from symspellpy.symspellpy import SymSpell\n","import pickle\n","import bz2\n","nltk.download('punkt')\n","nltk.download('stopwords')\n","\n","from tqdm import tqdm\n","from nltk.tokenize import RegexpTokenizer\n","from bs4 import BeautifulSoup\n","from nltk.corpus import stopwords\n","from collections import Counter\n","from nltk.stem.porter import PorterStemmer\n","from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\n","from sklearn.decomposition import TruncatedSVD\n","from sklearn.metrics.pairwise import cosine_similarity\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import classification_report"]},{"cell_type":"markdown","metadata":{"id":"3a22VZP2bRTz"},"source":["FUNCTION FOR PREPROCESSING DATA"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"N40QHAzAf2gA","executionInfo":{"status":"aborted","timestamp":1725377942451,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["#Removal of URL\n","def remove_url(text):\n","    url_pattern = re.compile(r'https?://\\S+|www\\.\\S+')\n","    return url_pattern.sub(r'', text)\n","\n","#Removal of HTML\n","def remove_html(text):\n","    html_pattern = re.compile(r'<.*?>')\n","    return html_pattern.sub(' ', str(text))\n","\n","#Removal of punctuations\n","def remove_punctuation(text):\n","  return re.sub(r'[^\\w\\s]', ' ', text)\n","\n","#Removal of numbers\n","def remove_numbers(text):\n","  return re.sub(\"^\\d+\\s|\\s\\d+\\s|\\s\\d+$\", ' ', text)\n","\n","#Removal of word containing numbers\n","def remove_word_containing_numbers(text):\n","  return re.sub('\\S*\\d\\S*', ' ', text)\n","\n","#Removal of short words\n","def remove_short_words(text, len_w=3):\n","  return ' '.join([w for w in text.split() if len(w) > len_w])\n","\n","#Removal of long words\n","def remove_long_words(text, len_w=25):\n","  return ' '.join([w for w in text.split() if len(w) < len_w])\n","\n","#Removal of frequent words\n","def remove_frequent(text, frequent_words):\n","  return ' '.join([w for w in text.split() if w not in frequent_words])\n","\n","#Correction words\n","sym_spell = SymSpell(max_dictionary_edit_distance = 0, prefix_length = 7)\n","dictionary_path = pkg_resources.resource_filename('symspellpy', 'frequency_dictionary_en_82_765.txt')\n","sym_spell.load_dictionary(dictionary_path, term_index = 0, count_index = 1)\n","\n","def word_correction(text):\n","  return str(sym_spell.word_segmentaion(text).corrected_string)"]},{"cell_type":"markdown","metadata":{"id":"GQy5dAGuyAor"},"source":["PREPARE TO PREPROCESSING DATA"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jOwahJlQ7S_A","executionInfo":{"status":"aborted","timestamp":1725377942451,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["csv_list = []\n","usecolumn = ['doi' , 'citationStringAnnotated']\n","column_name = 'citationStringAnnotated'"]},{"cell_type":"markdown","metadata":{"id":"OJPolEFeINrP"},"source":["Demo part (for n rows in each csv)"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":36,"status":"aborted","timestamp":1725377942451,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"Iuv2Ku7m8YPo"},"outputs":[],"source":["#Create data frame\n","for filename in tqdm(os.listdir(all_csv_path)):\n","  filepath = os.path.join(all_csv_path, filename)\n","  df = pd.read_csv(filepath, converters={'doi': str, 'citationStringAnnotated': str}, encoding = 'utf8', engine='python', sep = ',', nrows=200000)\n","  csv_list.append(df)"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":36,"status":"aborted","timestamp":1725377942451,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"19LCRv0r9Lf0"},"outputs":[],"source":["#Combine all the csv\n","csv_merged = pd.concat(csv_list, ignore_index=True)\n","csv_merged.head(800000)"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942452,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"INLZ7OfP9WFt"},"outputs":[],"source":["#Clean unused columns\n","csv_merged.drop('articleType', axis=1, inplace = True)\n","csv_merged.drop('citationStyle', axis=1, inplace = True)\n","csv_merged.head(5)"]},{"cell_type":"markdown","metadata":{"id":"V7HxjAxD-N6U"},"source":["Preprocessing data"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942452,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"yahMguoOGzP3"},"outputs":[],"source":["#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":36,"status":"aborted","timestamp":1725377942452,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"SvfmN6dKB9GN"},"outputs":[],"source":["#Remove duplicated rows\n","print(f'original number of rows: {csv_merged.shape[0]}')\n","csv_merged = csv_merged.drop_duplicates(subset=['citationStringAnnotated'])\n","print(f'after remove duplicate rows: {csv_merged.shape[0]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942453,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"vET72ngZ-KFE"},"outputs":[],"source":["#Lower case\n","csv_merged[column_name] = csv_merged[column_name].str.lower()\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942453,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"9wjnKzjXDqeZ"},"outputs":[],"source":["#Remove URL\n","csv_merged[column_name] = csv_merged[column_name].apply(lambda x: remove_url(x))\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942453,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"49xr-UG3__xK"},"outputs":[],"source":["#Remove HTML tag\n","csv_merged[column_name] =csv_merged[column_name].apply(lambda x: remove_html(x))\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942454,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"dDYud8l-FGRx"},"outputs":[],"source":["#Remove punctuation\n","csv_merged[column_name] =csv_merged[column_name].apply(lambda x: remove_punctuation(x))\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942454,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"LQwysm1xGkrM"},"outputs":[],"source":["#Remove numbers\n","csv_merged[column_name] =csv_merged[column_name].apply(lambda x: remove_numbers(x))\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942454,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"yrHTUacEG6bP"},"outputs":[],"source":["#Remove word containing numbers\n","csv_merged[column_name] =csv_merged[column_name].apply(lambda x: remove_word_containing_numbers(x))\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942454,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"nUl74cEWKlc2"},"outputs":[],"source":["#Remove short words\n","csv_merged[column_name] =csv_merged[column_name].apply(lambda x: remove_short_words(x))\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942455,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"GWlj3gM2LXbm"},"outputs":[],"source":["#Remove long words\n","csv_merged[column_name] =csv_merged[column_name].apply(lambda x: remove_long_words(x))\n","#Show data (i = number of rows that are shown)\n","num_to_show = 20\n","for i in range(num_to_show):\n","  print(f'row {i + 1}: {csv_merged[column_name].values[i]}')"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942455,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"V9zAQypUKef3"},"outputs":[],"source":["#Check for the most frequent words\n","cnt = Counter ()\n","for text in csv_merged[column_name].values:\n","  for word in text.split():\n","    cnt[word] += 1\n","\n","for item in cnt.most_common(50):\n","  print(item)"]},{"cell_type":"markdown","metadata":{"id":"-F6fUb6_YS-2"},"source":["LSA MODELS"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rfzPlHB2erhY","executionInfo":{"status":"aborted","timestamp":1725377942455,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["# Open the file in write mode\n","with open('data.pkl', 'wb') as f:\n","# Pickle the object and write it to the file\n","  pickle.dump(csv_merged, f)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xHsphdIIeD7Z","executionInfo":{"status":"aborted","timestamp":1725377942455,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["# Open the file in read mode\n","with open('data.pkl','rb') as f:\n","# Load the object from the file\n","  csv_merged = pickle.load(f)"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":37,"status":"aborted","timestamp":1725377942455,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"},"user_tz":-420},"id":"7uRlTXZzpNdq"},"outputs":[],"source":["#TF-IDF\n","column_name = 'citationStringAnnotated'\n","vectorizer = TfidfVectorizer(stop_words='english', max_df=0.7, smooth_idf=True)\n","X = vectorizer.fit_transform(csv_merged[column_name])\n","print(X.shape)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"u23G5V4ss0yI","executionInfo":{"status":"aborted","timestamp":1725377942455,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["#SVD\n","svd_model = TruncatedSVD(n_components=50, algorithm='randomized', n_iter=100, random_state=59)\n","svd_model.fit(X)\n","len(svd_model.components_)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uCRxTj8MtfiV","executionInfo":{"status":"aborted","timestamp":1725377942455,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["#Output 50 topics base on SVD with 10 important words each\n","terms = vectorizer.get_feature_names_out()\n","for i, comp in enumerate(svd_model.components_):\n","  terms_comp = zip(terms, comp)\n","  sorted_terms = sorted(terms_comp, key= lambda x:x[1], reverse=True)[:10]\n","  topic = [w for w, score in sorted_terms]\n","  print(f\"\\Topic {i}: {topic}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MfEddp4Qv_nE","executionInfo":{"status":"aborted","timestamp":1725377942455,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["#Find article with the most similar to the keyword of topics\n","def similar_document(query, num_doc):\n","  query_vector = vectorizer.transform(query)\n","  query_vector_matrix = svd_model.transform(query_vector)\n","  X_matrix = svd_model.transform(X)\n","  similarity = cosine_similarity(query_vector_matrix, X_matrix)\n","  max_i = np.argsort(similarity)[::-1][:num_doc]\n","  for a in max_i:\n","    print(csv_merged.iloc[a].values)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qoeJm6wkw3HA","executionInfo":{"status":"aborted","timestamp":1725377942456,"user_tz":-420,"elapsed":37,"user":{"displayName":"Hoàng Gia Ân Trần","userId":"01349244281681544775"}}},"outputs":[],"source":["query = ['medical']\n","similar_document(query,20)"]}],"metadata":{"colab":{"provenance":[{"file_id":"1t8haNgx13-glCAjA763O7usJafUnN0Or","timestamp":1684912910701},{"file_id":"12QqsVELwK_gz3Pquj9GR3_ZeZEzRh_Ch","timestamp":1684857709224},{"file_id":"13XPJDtAugleAgy5JDv_ZUkXOVasEZJsb","timestamp":1684650544111}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}